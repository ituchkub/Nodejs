const strMssql = require('../../utils/mssql/str.mssql');

class strService {
  async getStep1(req) {
    try {
      const output = await strMssql.getStep1(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep1(req) {
    try {
      const output = await strMssql.postStep1(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage,
        mailTemplate: output.output.pMailTemplate,
        mailFrom: output.output.pMailFrom,
        mailTo: output.output.pMailTo,
        mailCc: output.output.pMailCc
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep2(req) {
    try {
      const output = await strMssql.getStep2(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep2(req) {
    try {
      const output = await strMssql.postStep2(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage,
        mailTemplate: output.output.pMailTemplate,
        mailFrom: output.output.pMailFrom,
        mailTo: output.output.pMailTo,
        mailCc: output.output.pMailCc
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep2TolueneTest(req) {
    try {
      const output = await strMssql.getStep2TolueneTest(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep2TolueneTest(req) {
    try {
      const output = await strMssql.postStep2TolueneTest(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep3(req) {
    try {
      const output = await strMssql.getStep3(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep3(req) {
    try {
      const output = await strMssql.postStep3(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage,
        mailTemplate: output.output.pMailTemplate,
        mailFrom: output.output.pMailFrom,
        mailTo: output.output.pMailTo,
        mailCc: output.output.pMailCc
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep3SulphateTest(req) {
    try {
      const output = await strMssql.getStep3SulphateTest(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep3SulphateTest(req) {
    try {
      const output = await strMssql.postStep3SulphateTest(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep4(req) {
    try {
      const output = await strMssql.getStep4(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep4(req) {
    try {
      const output = await strMssql.postStep4(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage,
        mailTemplate: output.output.pMailTemplate,
        mailFrom: output.output.pMailFrom,
        mailTo: output.output.pMailTo,
        mailCc: output.output.pMailCc
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep4Approval(req) {
    try {
      const output = await strMssql.getStep4Approval(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep4Approval(req) {
    try {
      const output = await strMssql.postStep4Approval(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep4ContaminantCheck(req) {
    try {
      const output = await strMssql.getStep4ContaminantCheck(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep4ContaminantCheck(req) {
    try {
      const output = await strMssql.postStep4ContaminantCheck(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep4ContaminantCheckEmployee(req) {
    try {
      const output = await strMssql.getStep4ContaminantCheckEmployee(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep4ContaminantCheckEmployee(req) {
    try {
      const output = await strMssql.postStep4ContaminantCheckEmployee(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async getStep5(req) {
    try {
      const output = await strMssql.getStep5(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        data: output.recordset,
        message: output.output.pMessage
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }

  async postStep5(req) {
    try {
      const output = await strMssql.postStep5(req.body);

      if (output.output.pStatus != 1) {
        throw output.output.pMessage;
      }

      let res = {
        status: true,
        pid: output.output.pId,
        message: output.output.pMessage,
        mailTemplate: output.output.pMailTemplate,
        mailFrom: output.output.pMailFrom,
        mailTo: output.output.pMailTo,
        mailCc: output.output.pMailCc
      }

      return res;
    } catch (error) {
      return {
        status: false,
        message: error.message ? error.message : error
      }
    }
  }
}

module.exports = new strService();